FROM weasyl-base

RUN apt-get update \
 && apt-get install -qyy \
  libffi-dev libmagickcore-dev libpq-dev libxml2-dev libxslt-dev pkg-config liblzma-dev python-dev \
 && apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

ENV WHEELHOUSE=/wheelhouse
ENV PIP_WHEEL_DIR=/wheelhouse
ENV PIP_FIND_LINKS=/wheelhouse

VOLUME /wheelhouse
VOLUME /weasyl-src
VOLUME /var/cache/weasyl/.cache

ENTRYPOINT ["as-weasyl", "pip", "wheel", "/weasyl-src", "/weasyl-src/libweasyl", "/weasyl-src/_wzl"]
